<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>≈òazen√≠ bibliografick√Ωch citac√≠</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/png" sizes="16x16" href="favicons/favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicons/favicon-32x32.png">
  <link rel="apple-touch-icon" sizes="180x180" href="favicons/apple-touch-icon.png">
</head>
<body>
  <div class="github-link">
    <a href="https://github.com/the-maty/prevedeni-citace-word" target="_blank" rel="noopener">üìñ N√°vod</a>
  </div>  
  <div class="container">

    <h1>üìö Se≈ôazen√≠ bibliografie podle ƒçesk√© abecedy</h1>

    <!-- Tlaƒç√≠tko pro otev≈ôen√≠ makra -->
    <div class="macro-box">
      <p>Toto makro umo≈æn√≠ rychl√Ω p≈ôevod citac√≠ z form√°tu [1] na {{1}} ve Wordu. Kliknut√≠m zobraz√≠te k√≥d a m≈Ø≈æete si ho rovnou zkop√≠rovat do schr√°nky.</p>
      <button onclick="toggleMacro()">üìã Zobrazit / Kop√≠rovat makro</button>
      
      <div id="macroContent" style="display: none; margin-top: 1rem;">
        <pre id="macroCode"><code>Sub PrevestNaZavorky()
    Dim i As Integer

    For i = 1 To 99
        With Selection.Find
            .ClearFormatting
            .Replacement.ClearFormatting
            .Text = "[" & i & "]"
            .Replacement.Text = "{{" & i & "}}"
            .Forward = True
            .Wrap = wdFindContinue
            .Execute Replace:=wdReplaceAll
        End With
    Next i

    MsgBox "Hotovo! V≈°echny citace p≈ôevedeny na {{x}} form√°t.", vbInformation
End Sub</code></pre>
        <button onclick="copyMacro()">Kop√≠rovat makro do schr√°nky</button>
      </div>
    </div>

    <!-- Popis k textarea -->
    <p>Vlo≈æte seznam citac√≠ (ka≈æd√° zaƒç√≠naj√≠c√≠ nap≈ô. <code>[1]</code>) a kliknƒõte na tlaƒç√≠tko <b>Se≈ôadit</b></p>

    <textarea id="input" placeholder="Vlo≈æte citace zde..."></textarea>

    <div class="buttons">
      <button onclick="sortCitations()">Se≈ôadit</button>
      <button onclick="copyOutput()">Kop√≠rovat v√Ωstup</button>
      <button onclick="copyMapping()">Kop√≠rovat mapov√°n√≠ pro Win</button>
    </div>

    <textarea id="output" readonly placeholder="Zde bude v√Ωstup..."></textarea>
    <textarea id="vbsOutput" readonly placeholder="VBScript mapping..."></textarea>

    <footer class="footer">
      üë®‚Äçüç≥ Uva≈ôil <a href="https://github.com/the-maty" target="_blank" rel="noopener">MaTy</a> ¬© 2025
    </footer>
  </div>

  <script src="main.js"></script>
  <script>
    function toggleMacro() {
      const macro = document.getElementById("macroContent");
      if (macro.style.display === "none") {
        macro.style.display = "block";
      } else {
        macro.style.display = "none";
      }
    }

    function copyMacro() {
      const macro = document.getElementById("macroCode").innerText;
      navigator.clipboard.writeText(macro).then(function() {
        alert("Makro bylo zkop√≠rov√°no!");
      }, function(err) {
        alert("Nepoda≈ôilo se zkop√≠rovat makro: ", err);
      });
    }
  </script>
</body>
</html>
